(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{3388:(e,a,t)=>{"use strict";t.d(a,{default:()=>o});var r=t(5155),s=t(4540),l=t(8990),n=t(2115);let o=()=>{let e=(0,s.wA)(),a=(0,s.d4)(e=>e.auth),[t,o]=(0,n.useState)({name:"",email:"",password:""}),d=e=>{o({...t,[e.target.name]:e.target.value})};return(0,r.jsxs)("form",{onSubmit:a=>{a.preventDefault(),e((0,l.DY)(t))},className:"space-y-4",children:[(0,r.jsx)("input",{type:"text",name:"name",placeholder:"Name",value:t.name,onChange:d,className:"border p-2 w-full"}),(0,r.jsx)("input",{type:"email",name:"email",placeholder:"Email",value:t.email,onChange:d,className:"border p-2 w-full"}),(0,r.jsx)("input",{type:"password",name:"password",placeholder:"Password",value:t.password,onChange:d,className:"border p-2 w-full"}),(0,r.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded",children:"Register"}),a.isLoading&&(0,r.jsx)("p",{children:"Loading..."}),a.error&&(0,r.jsx)("p",{className:"text-red-500",children:a.error}),a.user&&(0,r.jsxs)("p",{className:"text-green-600",children:["Welcome ",a.user.name,"!"]})]})}},5230:(e,a,t)=>{Promise.resolve().then(t.bind(t,3388))},8990:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>C,DY:()=>n,ET:()=>c,H$:()=>y,Kc:()=>k,Lx:()=>o,ZB:()=>f,ck:()=>w,im:()=>d,jc:()=>p,mB:()=>m});var r=t(1990),s=t(3464);let l={user:null,token:localStorage.getItem("token"),isLoading:!1,isAuthenticated:!1,error:null,message:null},n=(0,r.zD)("auth/register",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=await s.A.post("".concat("http://localhost:8000/api/","auth/register"),e,{withCredentials:!0}),t=a.data.data||a.data.user,r=a.data.token||"dummy-token";return r&&localStorage.setItem("token",r),{user:t,token:r}}catch(e){var r,l;return t((null==(l=e.response)||null==(r=l.data)?void 0:r.message)||"Registration failed")}}),o=(0,r.zD)("auth/login",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=await s.A.post("".concat("http://localhost:8000/api/","auth/login"),e,{withCredentials:!0}),t=a.data.data,r=a.data.token||"dummy-token";return r&&localStorage.setItem("token",r),{user:t,token:r}}catch(e){var r,l;return t((null==(l=e.response)||null==(r=l.data)?void 0:r.message)||"Login failed")}}),d=(0,r.zD)("auth/fetchUser",async(e,a)=>{let{rejectWithValue:t}=a;try{let e=localStorage.getItem("token"),a=await s.A.get("".concat("http://localhost:8000/api/","auth/"),{withCredentials:!0,headers:e?{Authorization:"Bearer ".concat(e)}:{}});return{user:a.data.data||a.data.user||a.data}}catch(e){var r,l;return t((null==(l=e.response)||null==(r=l.data)?void 0:r.message)||"Failed to get profile")}}),i=(0,r.Z0)({name:"auth",initialState:l,reducers:{clearAuth:e=>{e.user=null,e.token=null,e.isAuthenticated=!1,e.error=null,e.message=null,localStorage.removeItem("token")},clearError:e=>{e.error=null},clearMessage:e=>{e.message=null},setCredentials:(e,a)=>{e.user=a.payload.user,e.token=a.payload.token,e.isAuthenticated=!0,localStorage.setItem("token",a.payload.token)}},extraReducers:e=>{e.addCase(n.pending,e=>{e.isLoading=!0,e.error=null,e.message=null}).addCase(n.fulfilled,(e,a)=>{e.isLoading=!1,e.user=a.payload.user,e.token=a.payload.token,e.isAuthenticated=!0,e.message="Registration successful",e.error=null}).addCase(n.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload||"Registration failed",e.isAuthenticated=!1}).addCase(o.pending,e=>{e.isLoading=!0,e.error=null,e.message=null}).addCase(o.fulfilled,(e,a)=>{e.isLoading=!1,e.user=a.payload.user,e.token=a.payload.token,e.isAuthenticated=!0,e.message="Login successful",e.error=null}).addCase(o.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload||"Login failed",e.isAuthenticated=!1}).addCase(d.pending,e=>{e.isLoading=!0,e.error=null}).addCase(d.fulfilled,(e,a)=>{e.isLoading=!1,e.user=a.payload.user,e.isAuthenticated=!0,e.error=null}).addCase(d.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload||"Failed to get profile",e.isAuthenticated=!1})}}),{clearAuth:u,clearError:c,clearMessage:g,setCredentials:h}=i.actions,p=e=>e.auth,m=e=>e.auth.user,k=e=>e.auth.isAuthenticated,y=e=>e.auth.isLoading,f=e=>e.auth.error,w=e=>{var a;return null==(a=e.auth.user)?void 0:a.role},C=i.reducer}},e=>{e.O(0,[464,635,441,964,358],()=>e(e.s=5230)),_N_E=e.O()}]);